.main.main-content.col-lg-10.p-0.offset-sm-0.ml-3
  .main-content-container.container-fluid
    / Page Header
    .page-header.row.no-gutters.py-4
      .col-6.col-sm-4.text-center.text-sm-left.mb-0
        %span.text-uppercase.page-subtitle Overview
        %h3.page-title Record Deposits
      .col-md-8
        = link_to 'Summary of Collection', summary_collections_path, :class=>"mt-3 btn btn-sm btn-primary mr-1 float-right"
    / End Page Header
    / Default Light Table
    .row
      .col
        = form_for("up", url: "/subsidiary_ledgers/?customer_id=#{params['customer_id']}&start_date=#{params['id']}", method: "get") do |g|
          .row#datepicker_form_row.ml-1.mb-4
            = g.label "Date Filter", :class=>"label-date"
            .col-date
              .col-md-2
                = g.date_field :start_date, :class=> "form-control"
              .col-md-2
                = g.date_field :end_date, :class=> "form-control"
              .col-md-2
                .actions
                  = g.submit "Submit", class: "btn btn-primary btn-sm"
        %table.table.table-striped.table-bordered#exportables1{:role => 'datatable'}
          %thead
            %tr
              %th OR num
              %th Received From
              %th From Account
              %th Memo
              %th Chk No.
              %th Payment Date
              %th PMT Meth
              %th Amount
              %th Action
          %tbody
            - @customer_ledger_undeposited.each do |ledger|
              %tr
                %td 
                  = ledger.or_num
                %td
                  = link_to ledger.amortization.customer, "/summary_reports/?amortization=#{ledger.amortization.id}"
                %td= ledger.ar_name
                %td= ledger.memo
                %td 
                  = ledger.check_no
                  -#= format_num(ledger.running_balance)
                -#ledger.amortization.contract_price
                %td 
                  = ledger.payment_date
                %td
                  = ledger.mode_of_payment
                %td
                  - if ledger.downpayment.to_i > 0 || ledger.processing_fee.to_i > 0
                    = format_num(ledger.downpayment + ledger.processing_fee) 
                  - else
                    = format_num(ledger.interest + ledger.principal)
                %td{"data-id" => "#{ledger.id}", "data-target" => "#editModal", "data-toggle" => "modal", :class => "btn"}
                  Deposit
        #editModal.modal.fade{"aria-hidden" => "true", "aria-labelledby" => "basicModal", :role => "dialog", :tabindex => "-1"}
          .modal-dialog.modal-deposit
            .modal-content
              .modal-header
                .modal-title
                  %b Record Deposit
                %a{"data-dismiss" => "modal", :href => "#", :class=> "y-btn"}
                  %strong X
                %span
                  
              .modal-body
                -#%form.form-horizontal{:action => "/record_deposit", :method => "post"}
                = form_for 'record_deposit', url: ('/record_deposit') do |f|
                  %fieldset#modal_form
                      
                    .form-row
                      = f.text_field :payment_history_id, {:required => true, :hidden => true,:class => "form-control form-control input-md", :id => "payment_history_id"}
                 
                      = f.label :deposit_to, :class=>"text-muted"
                      -#= f.text_field :deposit_to, {:required => true, :class => "form-control form-control input-md", :id => "deposit_to"}
                      = f.select :deposit_to, options_for_select(BankAccount.all.order(:name).collect{ |u| [u.name, u.id]}), {:required => "true"}, :class=>"form-control"
                    
                      = f.label :memo, :class=>"text-muted col-md-4 control-label"
                      = f.text_field :record_deposit_memo, {:required => true, :class => "form-control form-control input-md", :id => "record_deposit_memo"}
                
                      = f.label :date_paid, :class=>"text-muted col-md-4 control-label"
                      = f.date_field :date_paid, {:required => true, :class => "form-control form-control input-md", :id => "date_paid"}
                    .modal-footer.mt-4
                      %button.btn.btn-primary{:type => "submit", :class => "btn-create"} Save

:javascript
  $(function(){
    $('#editModal').modal({
        keyboard: true,
        backdrop: "static",
        show:false,
        
    }).on('show', function(){
        console.log("GETTING");
        var getIdFromRow = $(event.target).closest('tr').data('id');
        console.log(getIdFromRow);
        //make your ajax call populate items or what even you need
        $(this).find('#orderDetails').html($('<b> Order Id selected: ' + getIdFromRow  + '</b>'))
    });
  });

  $(".table-striped").find('td[data-id]').on('click', function () {
    console.log($(this).data('id'));
    $('#payment_history_id').val($(this).data('id'));
    //$('#orderModal').modal('show');

  });
  